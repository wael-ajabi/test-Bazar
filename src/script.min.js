import"./style.scss";import*as THREE from"three";import*as TWEEN from"@tweenjs/tween.js";import{GLTFLoader}from"three/examples/jsm/loaders/GLTFLoader.js";import{DRACOLoader}from"three/examples/jsm/loaders/DRACOLoader";import{OrbitControls}from"three/examples/jsm/controls/OrbitControls";import{Sky}from"three/examples/jsm/objects/Sky.js";import*as dat from"dat.gui";import{EffectComposer}from"three/examples/jsm/postprocessing/EffectComposer.js";import{SAOPass}from"three/examples/jsm/postprocessing/SAOPass.js";import{ColladaLoader}from"three/examples/jsm/loaders/ColladaLoader.js";import{RenderPass}from"three/examples/jsm/postprocessing/RenderPass.js";import{UnrealBloomPass}from"three/examples/jsm/postprocessing/UnrealBloomPass.js";import{BokehPass}from"./BokehPass.js";import TextSprite from"@seregpie/three.text-sprite";import{gsap}from"gsap";import{ReinhardToneMapping,Vector3}from"three";let composer,singleMaterial,zmaterial,nobjects,cubeMaterial;const materials1=[],objects=[],$=(s,o=document)=>o.querySelector(s),$$=(s,o=document)=>o.querySelectorAll(s);$$(".button").forEach(el=>el.addEventListener("mousemove",(function(e){const pos=this.getBoundingClientRect(),mx=e.clientX-pos.left-pos.width/2,my=e.clientY-pos.top-pos.height/2;this.style.transform="translate("+.15*mx+"px, "+.3*my+"px)",this.style.transform+="rotate3d("+-.1*mx+", "+-.3*my+", 0, 12deg)"}))),$$(".button").forEach(el=>el.addEventListener("mouseleave",(function(){this.style.transform="translate3d(0px, 0px, 0px)",this.style.transform+="rotate3d(0, 0, 0, 0deg)"}))),$$("li").forEach(el=>el.addEventListener("mousemove",(function(e){const pos=this.getBoundingClientRect(),mx=e.clientX-pos.left-pos.width/2,my=e.clientY-pos.top-pos.height/2;this.style.transform="translate("+.15*mx+"px, "+.3*my+"px)",this.style.transform+="rotate3d("+-.1*mx+", "+-.3*my+", 0, 12deg)"}))),$$("li").forEach(el=>el.addEventListener("mouseleave",(function(){this.style.transform="translate3d(0px, 0px, 0px)",this.style.transform+="rotate3d(0, 0, 0, 0deg)"})));var soundcheck=!0;function init(){let toolTimeline,duration=.9;(new gsap.timeline).staggerTo("li",.9,{top:30,ease:"Back.easeOut"},.1,.9)}function initsound(){let toolTimeline,duration=.9;(new gsap.timeline).staggerTo("#sound",.9,{top:30,ease:"Back.easeOut"},.1,.9)}function increase(){let SPEED=120,limit=parseInt(document.getElementById("value1").innerHTML,10);for(let i=0;i<=limit;i++)setTimeout((function(){document.getElementById("value1").innerHTML=i+"%"}),120*i)}document.getElementById("sound").onclick=function(){soundcheck?(mediaElement.pause(),soundcheck=!1,document.getElementById("sound").innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">\n  <path stroke-linecap="round" stroke-linejoin="round" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd" />\n  <path stroke-linecap="round" stroke-linejoin="round" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />\n</svg>'):(mediaElement.play(),soundcheck=!0,document.getElementById("sound").innerHTML='<svg id="soundIcon" xmlns="http://www.w3.org/2000/svg" class="h-1 w-1" fill="#AB7C94" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">\n<path stroke-linecap="round" stroke-linejoin="round" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />\n</svg>')},increase();const STAR_COLOR="#fff",STAR_SIZE=3,STAR_MIN_SCALE=.2,OVERFLOW_THRESHOLD=50,STAR_COUNT=(window.innerWidth+window.innerHeight)/8;var canvas2=document.getElementById("load"),context=canvas2.getContext("2d");let scale=1,width,height,stars=[],pointerX,pointerY,velocity={x:0,y:0,tx:0,ty:0,z:5e-4},touchInput=!1;function generate(){for(let i=0;i<STAR_COUNT;i++)stars.push({x:0,y:0,z:.2+.8*Math.random()})}function placeStar(star){star.x=Math.random()*width,star.y=Math.random()*height}function recycleStar(star){let direction="z",vx=Math.abs(velocity.x),vy=Math.abs(velocity.y);if(vx>1||vy>1){let axis;axis=vx>vy?Math.random()<vx/(vx+vy)?"h":"v":Math.random()<vy/(vx+vy)?"v":"h",direction="h"===axis?velocity.x>0?"l":"r":velocity.y>0?"t":"b"}star.z=.2+.8*Math.random(),"z"===direction?(star.z=.1,star.x=Math.random()*width,star.y=Math.random()*height):"l"===direction?(star.x=-50,star.y=height*Math.random()):"r"===direction?(star.x=width+50,star.y=height*Math.random()):"t"===direction?(star.x=width*Math.random(),star.y=-50):"b"===direction&&(star.x=width*Math.random(),star.y=height+50)}function resize(){scale=window.devicePixelRatio||1,width=window.innerWidth*scale,height=window.innerHeight*scale,canvas2.width=width,canvas2.height=height,stars.forEach(placeStar)}function step(){context.clearRect(0,0,width,height),update(),render(),requestAnimationFrame(step)}function update(){velocity.tx*=.3,velocity.ty*=.3,velocity.x+=.1*(velocity.tx-velocity.x),velocity.y+=.1*(velocity.ty-velocity.y),stars.forEach(star=>{star.x+=velocity.x*star.z,star.y+=velocity.y*star.z,star.x+=(star.x-width/2)*velocity.z*star.z,star.y+=(star.y-height/2)*velocity.z*star.z,star.z+=velocity.z,(star.x<-50||star.x>width+50||star.y<-50||star.y>height+50)&&recycleStar(star)})}function render(){stars.forEach(star=>{context.beginPath(),context.lineCap="round",context.lineWidth=3*star.z*scale,context.globalAlpha=.5+.5*Math.random(),context.strokeStyle="#fff",context.beginPath(),context.moveTo(star.x,star.y);var tailX=2*velocity.x,tailY=2*velocity.y;Math.abs(tailX)<.1&&(tailX=.5),Math.abs(tailY)<.1&&(tailY=.5),context.lineTo(star.x+tailX,star.y+tailY),context.stroke()})}function movePointer(x,y){if("number"==typeof pointerX&&"number"==typeof pointerY){let ox=x-pointerX,oy=y-pointerY;velocity.tx=velocity.tx+ox/8*scale*(touchInput?1:-1),velocity.ty=velocity.ty+oy/8*scale*(touchInput?1:-1)}pointerX=x,pointerY=y}function onMouseMove(event){touchInput=!1,movePointer(event.clientX,event.clientY)}function onTouchMove(event){touchInput=!0,movePointer(event.touches[0].clientX,event.touches[0].clientY,!0),event.preventDefault()}function onMouseLeave(){pointerX=null,pointerY=null}generate(),resize(),step(),window.onresize=resize,canvas2.onmousemove=onMouseMove,canvas2.ontouchmove=onTouchMove,canvas2.ontouchend=onMouseLeave,document.onmouseleave=onMouseLeave;const gui=new dat.GUI,canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene;scene.background=new THREE.Color(new THREE.Color("rgb(143, 76, 0)"));var fonintensity=.2,fog=new THREE.FogExp2(new THREE.Color("rgb(188, 118, 067)"),fonintensity);const color=new THREE.Color("rgb(143, 76, 0)"),near=.1,far=14.6;scene.fog=new THREE.Fog(color,.1,far);const sizes={width:window.innerWidth,height:window.innerHeight},updateAllMaterials=()=>{scene.traverse(child=>{child instanceof THREE.Mesh&&child.material instanceof THREE.MeshStandardMaterial&&(child.material.needsUpdate=!0)})},renderer=new THREE.WebGLRenderer({canvas:canvas,antialias:!0});renderer.toneMapping=THREE.LinearToneMapping,gui.add(renderer,"toneMapping",{NO:THREE.NoToneMapping,Linear:THREE.LinearToneMapping,Reinhard:ReinhardToneMapping,Cineon:THREE.CineonToneMapping,ACESFilmic:THREE.ACESFilmicToneMapping}).onFinishChange(()=>{renderer.toneMapping=Number(renderer.toneMapping),updateAllMaterials()}),gui.add(renderer,"toneMappingExposure").min(0).max(10).step(.001),renderer.setSize(window.innerWidth,window.innerHeight),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.physicallyCorrectLights=!0,renderer.shadowMap.enabled=!1;const manager=new THREE.LoadingManager;manager.onLoad=function(){console.log("Loading complete!")},manager.onProgress=function(url,itemsLoaded,itemsTotal){console.log(`Items loaded: ${itemsLoaded}/${itemsTotal}`)},manager.onError=function(url){console.log("There was an error loading "+url)};var mesh=null;const gltfloader=new GLTFLoader(manager);var mixer1=null,action=null,dracoLoader=new DRACOLoader;dracoLoader.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/js/libs/draco/"),dracoLoader.preload(),gltfloader.setDRACOLoader(dracoLoader);var totalSize=4167680,glowYellow=new THREE.MeshBasicMaterial({color:new THREE.Color(.91,.77,0,1).multiplyScalar(100),toneMapped:!1}),glowBlue=new THREE.MeshBasicMaterial({color:new THREE.Color(0,.29,.26,1).multiplyScalar(100),toneMapped:!1}),glowBlueLight=new THREE.MeshBasicMaterial({color:new THREE.Color(0,.29,.26,1).multiplyScalar(8),toneMapped:!1}),glowRed=new THREE.MeshBasicMaterial({color:new THREE.Color(1,0,0,242,1).multiplyScalar(100),toneMapped:!1}),model=null;function createMarker(model,x,y,z){textureLoader.crossOrigin="";const map=textureLoader.load("./eye1.png");map.encoding=THREE.sRGBEncoding;const spriteMaterialFront=new THREE.SpriteMaterial({map:map}),spriteFront=new THREE.Sprite(spriteMaterialFront);spriteFront.position.set(x,y,z),spriteFront.scale.set(.09,.09,.09);const spriteMaterialRear=new THREE.SpriteMaterial({map:map,opacity:.3,transparent:!0,depthTest:!1}),spriteRear=new THREE.Sprite(spriteMaterialRear);spriteRear.position.set(x,y,z),spriteRear.scale.set(.09,.09,.09),scene.add(spriteFront,spriteRear)}gltfloader.load("./City_12.glb",(function(gltf){const textureLoader=new THREE.TextureLoader;model=gltf.scene;var obj=gltf.scene;gltf.castShadow=!0,gltf.receiveShadow=!0,console.log(gltf,"aaaaaaaaaaa"),gltf.scene.traverse(n=>{n.isMesh&&(n.castShadow=!0,n.receiveShadow=!0,n.material.map&&(n.material.map.anisotropy=16),"Palazzi:lambert2SG1"===n.material.name&&(n.material=glowYellow),"Palazzi:phong2SG1"!==n.material.name&&"AZZURROC"!==n.material.name||(n.material=glowBlue),"FUCSIA_C"===n.material.name&&(n.material=glowRed),"phong20"===n.material.name&&(n.material=glowBlueLight))}),mixer1=new THREE.AnimationMixer(gltf.scene),console.log(gltf.animations);for(var i=0;i<14;i++)(action=mixer1.clipAction(gltf.animations[i])).play();gltf.scene.rotation.y=3.1,gltf.scene.position.y=-3,gltf.scene.position.x=-3.5,gltf.scene.castShadow=!0,gltf.scene.receiveShadow=!0,gltf.scene.userData.ground=!0,scene.add(obj),gltf.animations,gltf.scene,gltf.scenes,gltf.cameras,gltf.asset}),(function(xhr){console.log(xhr.loaded/totalSize*100+"% loaded"),xhr.loaded}),(function(error){console.log("An error happened")})),document.getElementById("start-button").style.display="",setTimeout(()=>{let element3,element2;document.getElementById("chart").className="myelementfaster",document.getElementById("start-button").style.display="flex",document.getElementById("start-button").className="myelement1"},2e4);const loadingManager=new THREE.LoadingManager(()=>{const loadingScreen=document.getElementById("chart");loadingScreen.classList.add("fade-out"),loadingScreen.addEventListener("transitionend",onTransitionEnd)}),geomet=new THREE.BoxBufferGeometry(.1,.1,.1),material=new THREE.MeshBasicMaterial({color:65280}),cube=new THREE.Mesh(geomet,material);cube.name="cube",cube.position.set(-.8,-.5,.8),cube.scale.set(.4,.5,.8),scene.add(cube),cube.visible=!1;const arcade=new THREE.Mesh(geomet,material);arcade.name="arcade",arcade.position.set(.88,-.42,-.43),arcade.scale.set(.93,2.28,.97),scene.add(arcade),arcade.visible=!1;const cube2=new THREE.Mesh(geomet,material);cube2.name="mercato",cube2.position.set(-.101,-.5,-.24),cube2.scale.set(3.7,.5,2.4),scene.add(cube2),cube2.visible=!1;const cube2Folder3=gui.addFolder("positionsss");cube2Folder3.add(cube2.position,"x"),cube2Folder3.add(cube2.position,"y"),cube2Folder3.add(cube2.position,"z"),cube2Folder3.add(cube2.scale,"x"),cube2Folder3.add(cube2.scale,"y"),cube2Folder3.add(cube2.scale,"z"),cube2Folder3.open();const cube3=new THREE.Mesh(geomet,material);cube3.name="Razzi",cube3.position.set(-1.2,-.5,-.41),cube3.scale.set(8,.5,14),scene.add(cube3),cube3.visible=!1;const cube4=new THREE.Mesh(geomet,material);cube4.name="Centro",cube4.position.set(.58,-.54,.04),cube4.scale.set(2,1.35,2.1),scene.add(cube4),cube4.visible=!1;const cube5=new THREE.Mesh(geomet,material);cube5.name="Palazzo",cube5.position.set(.7,-.25,.589),cube5.scale.set(.4,5.2,.5),scene.add(cube5),cube5.visible=!1,window.addEventListener("resize",()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.gammaOutput=!0,renderer.gammaFactor=2}),renderer.gammaOutput=!0,renderer.gammaFactor=10,renderer.physicallyCorrectLights=!1;var camera=new THREE.PerspectiveCamera(60,sizes.width/sizes.height,.005,5e3);camera.position.x=-5.647376005341269,camera.position.y=.9998205247861698,camera.position.z=2.297861001350101,camera.rotation.set(77,77,77);const cubeFolder1=gui.addFolder("position");cubeFolder1.add(camera.position,"x"),cubeFolder1.add(camera.position,"y"),cubeFolder1.add(camera.position,"z"),cubeFolder1.open();var clientX=-300,clientY=-300,outerCursor=document.querySelector(".cursor--outer"),innerCursor=document.querySelector(".cursor--inner"),link=document.querySelector(".link"),initCursor=function(){document.addEventListener("mousemove",(function(e){clientX=e.clientX,clientY=e.clientY}));var render=function(){gsap.set(outerCursor,{x:clientX-25,y:clientY-25,delay:.08}),gsap.set(innerCursor,{x:clientX,y:clientY}),requestAnimationFrame(render)};requestAnimationFrame(render)};initCursor();const pointLight3=new THREE.PointLight(16777215,3.66,2);pointLight3.position.set(-24,8,45),pointLight3.scale.set(10,10,10),pointLight3.intensity=5,pointLight3.frustumCulled=!0,pointLight3.decay=1,pointLight3.distance=10,scene.add(pointLight3);const pointLight3Helper=new THREE.PointLightHelper(pointLight3),pointLight4=new THREE.PointLight(16777215,3.66,2);pointLight4.scale.set(1,1,1),pointLight4.position.x=-3.8,pointLight4.position.y=1.3,pointLight4.position.z=8.8,pointLight4.intensity=5,pointLight4.frustumCulled=!0,pointLight4.decay=1,pointLight4.distance=2.5,scene.add(pointLight4);const pointLight4Helper=new THREE.PointLightHelper(pointLight4),cubeFolder2=gui.addFolder("positionss");cubeFolder2.add(pointLight4.position,"x"),cubeFolder2.add(pointLight4.position,"y"),cubeFolder2.add(pointLight4.position,"z"),cubeFolder2.add(pointLight4.rotation,"x"),cubeFolder2.add(pointLight4.rotation,"y"),cubeFolder2.add(pointLight4.rotation,"z"),cubeFolder2.open();const PointLight2=new THREE.PointLight(16777215,3.66,3);PointLight2.scale.set(1,1,1),PointLight2.position.y=.8,PointLight2.frustumCulled=!0,PointLight2.shadow.bias=-1e-4,PointLight2.distance=2.5,PointLight2.castShadow=!0,scene.add(PointLight2);const PointLight2Helper=new THREE.PointLightHelper(PointLight2),pointLight=new THREE.PointLight(16777215,3.66,2);pointLight.scale.set(1,1,1),pointLight.position.x=-3.5,pointLight.position.y=3,pointLight.position.z=3,pointLight.intensity=5,pointLight.frustumCulled=!0,pointLight.decay=1,pointLight.distance=3.68,scene.add(pointLight);const pointLightHelper=new THREE.PointLightHelper(pointLight),controls=new OrbitControls(camera,canvas);controls.enableDamping=!1,controls.target=new THREE.Vector3(2.712046209109965,-14.138109038671452,4.431157214151357),controls.update();const moongeometry=new THREE.SphereBufferGeometry(.1,32,32),moonMaterial=new THREE.MeshPhongMaterial({roughness:5,metalness:0,map:THREE.ImageUtils.loadTexture("./moonmap4k1.jpg"),bumpMap:THREE.ImageUtils.loadTexture("./moonbump4k.jpg"),bumpScale:.02,fog:!1,intensity:50}),moonMesh=new THREE.Mesh(moongeometry,moonMaterial);moonMesh.receiveShadow=!0,moonMesh.castShadow=!0,moonMesh.position.x=2,moonMesh.position.set(-27,9,52),moonMesh.scale.set(30,30,30);const geometry=new THREE.BufferGeometry,vertices=[];mixer1&&mixer1.update();const textureLoader=new THREE.TextureLoader,sprite1=textureLoader.load("./particle.png"),sprite2=textureLoader.load("./particle.png"),sprite3=textureLoader.load("./particle.png"),sprite4=textureLoader.load("./particle.png"),sprite5=textureLoader.load("./particle.png");for(let i=0;i<25;i++){const x=2e3*Math.random()-1e3,y=2e3*Math.random()-1e3,z=2e3*Math.random()-1e3;vertices.push(x,y,z)}geometry.setAttribute("position",new THREE.Float32BufferAttribute(vertices,3));var parameters=[[[1,.2,.5],sprite2,5],[[.95,.2,.5],sprite3,5],[[.9,.05,.5],sprite1,5],[[.85,0,.5],sprite5,5],[[.8,0,.5],sprite4,5]];for(let i=0;i<parameters.length;i++){const color=parameters[i][0],sprite=parameters[i][1],size=parameters[i][2];var materials;(materials=new THREE.PointsMaterial({size:size,map:sprite,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0})).color.set(10506797),materials.fog=!1;const particles=new THREE.Points(geometry,materials);particles.rotation.x=6*Math.random(),particles.rotation.y=6*Math.random(),particles.rotation.z=6*Math.random(),scene.add(particles)}function label(text,xstart,ystart,zstart,xfinish,yfinsh,zfinish){const color2=new THREE.Color("#C0C0C0"),geometry2=new THREE.IcosahedronGeometry(1,15),material1=new THREE.MeshBasicMaterial({color:color2}),sphere=new THREE.Mesh(geometry2,material1);sphere.fog=!1,geometry2.fog=!1,material1.fog=!1,sphere.position.set(xstart,ystart,zstart),sphere.scale.set(.01,.01,.01),scene.add(sphere);const material3=new THREE.LineBasicMaterial({color:12632256}),material4=new THREE.LineBasicMaterial({color:12632256}),points4=[];points4.push(new THREE.Vector3(-8,10,0)),points4.push(new THREE.Vector3(0,10,0)),points4.push(new THREE.Vector3(3,5,0)),points4.push(new THREE.Vector3(-8,5,0));const geometry4=(new THREE.BufferGeometry).setFromPoints(points4),square=new THREE.Line(geometry4,material4);square.scale.set(.05,.05,.05),square.position.set(-1.2,-.25,.89);var sprite=new TextSprite({text:text,fontFamily:"Saira",fontSize:.09,color:"#FF0000",fontWeight:"bold"});sprite.fog=!1,sprite.position.set(xfinish,yfinsh,zfinish);const points=[];scene.add(sprite),points.push(new THREE.Vector3(sphere.position.x,sphere.position.y,sphere.position.z)),points.push(new THREE.Vector3(sprite.position.x,sprite.position.y-.07,sprite.position.z));const geometry3=(new THREE.BufferGeometry).setFromPoints(points),line=new THREE.Line(geometry3,material3);scene.add(line)}var camerarotation=!1,mediaElement=null,myInterval=null;controls.enabled=!0,document.getElementById("start-button").onclick=function(){let element2,element;document.getElementById("start-button").className="myelementfaster",setTimeout(()=>{const element=document.getElementById("load");element.remove();const elementt=document.getElementById("cover");elementt.remove()},3e3),controls.enabled=!1,initsound(),document.getElementById("load").className="myelement",myInterval=setInterval(()=>{fog.density>.39||fog.density<.4&&(fonintensity+=.01,fog.density=fonintensity)},100),gsap.to(controls.target,{x:2.712046209109965,y:-14.138109038671452,z:4.431157214151357,duration:2}),gsap.to(camera.position,{x:-5.647376005341269,y:.9998205247861698,z:2.297861001350101,duration:3}),gsap.to(camera.position,{x:-4.85107488034725,y:.5,z:5.421262376769432,duration:10,delay:3,ease:"power1"}),gsap.to(controls.target,{x:-.32780258586027866,y:-.2927804605540083,z:-.12120864558705574,duration:7,delay:2}),gsap.to(camera.position,{x:-.9368241147924617,y:.44978222785543465,ease:"power1",z:-1.7328521118110993,duration:15,delay:8,onComplete:function(){init(),camerarotation=!1,controls.maxDistance=4,createMarker(model,-.8,-.4,.8),createMarker(model,-.101,-.4,-.24),createMarker(model,-.8,-.4,-.41),createMarker(model,.7,.1,.589),createMarker(model,.58,-.4,.04);var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass),controls.enabled=!0,controls.addEventListener("change",(function(){_v.copy(controls.target),controls.target.clamp(minPan,maxPan),_v.sub(controls.target),camera.position.sub(_v)})),controls.maxPolarAngle=Math.PI/2,clearInterval(myInterval)}});const listener=new THREE.AudioListener,audio=new THREE.Audio(listener),file="./16195580_space_by_whitewind-studio_preview.mp3";if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)){const loader=new THREE.AudioLoader;loader.load(file,(function(buffer){audio.setBuffer(buffer),audio.play()}))}else(mediaElement=new Audio(file)).play(),audio.setMediaElementSource(mediaElement)};const raycaster=new THREE.Raycaster,clickMouse=new THREE.Vector2,moveMouse=new THREE.Vector2;var arrayOfEyes=[];function intersect(pos){return raycaster.setFromCamera(pos,camera),raycaster.intersectObject(cube)}var clickActive=!1;window.addEventListener("dblclick",event=>{const found=intersect(clickMouse);if(found.length>0&&!clickActive){for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!1;controls.enabled=!1,clickMouse.x=event.clientX/window.innerWidth*2-1,clickMouse.y=-event.clientY/window.innerHeight*2+1,minPan=new THREE.Vector3(-1,-1,-1),maxPan=new THREE.Vector3(1,1,1),gsap.to(controls.target,{x:-.7895943789584624,y:-.49343959037131463,z:.7758244771913646,duration:1,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.665,y:-.475,z:.69,duration:3,delay:1,onComplete:function(){document.getElementsByClassName("nav")[0].style.bottom="95%",camerarotation=!1,document.getElementById("guibazar").style.display="block";var bokehPass=new BokehPass(scene,camera,{focus:.5,aperture:.005,maxblur:5,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)}}),clickActive=!0}});var minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),_v=new THREE.Vector3;function intersectArcade(pos){return raycaster.setFromCamera(pos,camera),raycaster.intersectObject(arcade)}document.getElementById("guibazar").onclick=function(){minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),camerarotation=!0,document.getElementById("guibazar").style.display="none",gsap.to(controls.target,{x:-.330176,y:-.291718,z:-.113545,duration:4,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.24905360247937205,y:.44321605716014717,z:-1.7252216405242373,duration:4,onComplete:function(){controls.enabled=!0;for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!0}}),clickActive=!1;var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)};var clickActive=!1;function intersectmercato(pos){return raycaster.setFromCamera(pos,camera),raycaster.intersectObject(cube2)}window.addEventListener("dblclick",event=>{const found=intersectArcade(clickMouse);if(found.length>0&&!clickActive){for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!1;console.log(boooob)}}),document.getElementById("guibazar").onclick=function(){minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),camerarotation=!0,document.getElementById("guibazar").style.display="none",gsap.to(controls.target,{x:-.330176,y:-.291718,z:-.113545,duration:4,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.24905360247937205,y:.44321605716014717,z:-1.7252216405242373,duration:4,onComplete:function(){controls.enabled=!0;for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!0}}),clickActive=!1;var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)};var clickActive=!1;function intersectrazzi(pos){return raycaster.setFromCamera(pos,camera),raycaster.intersectObject(cube3)}window.addEventListener("dblclick",event=>{clickMouse.x=event.clientX/window.innerWidth*2-1,clickMouse.y=-event.clientY/window.innerHeight*2+1;const found=intersectmercato(clickMouse);if(console.log(found),found.length>0&&!clickActive){for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!1;controls.enabled=!1,minPan=new THREE.Vector3(-1,-1,-1),maxPan=new THREE.Vector3(1,1,1),controls.maxPolarAngle=Math.PI,gsap.to(controls.target,{x:-.06652219660019898,y:-.49817622607328704,z:.09562768959498957,duration:2,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.3197533397689743,y:-.555449899400478,z:-.1868991838525571,duration:2,onComplete:function(){clickActive=!0,camerarotation=!1,document.getElementsByClassName("nav")[0].style.bottom="95%",document.getElementById("guimarcato").style.display="block";var bokehPass=new BokehPass(scene,camera,{focus:.1,aperture:.005,maxblur:4,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)}})}}),document.getElementById("guimarcato").onclick=function(){minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),camerarotation=!0,document.getElementById("guimarcato").style.display="none",gsap.to(controls.target,{x:-.330176,y:-.291718,z:-.113545,duration:4,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.24905360247937205,y:.44321605716014717,z:-1.7252216405242373,duration:4,onComplete:function(){controls.enabled=!0;for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!0}}),clickActive=!1;var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)};var clickActive=!1;function intersectcentro(pos){return raycaster.setFromCamera(pos,camera),raycaster.intersectObject(cube4)}window.addEventListener("dblclick",event=>{clickMouse.x=event.clientX/window.innerWidth*2-1,clickMouse.y=-event.clientY/window.innerHeight*2+1;const found=intersectrazzi(clickMouse);if(console.log(found),found.length>0&&!clickActive){for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!1;controls.enabled=!1,clickActive=!0,gsap.to(controls.target,{x:-.8289567293538739,y:-.3299689356758495,z:-.45931347935989586,duration:2,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.2948241421524178,y:-.07897252364587554,z:-.6011721977773161,duration:2,onComplete:function(){camerarotation=!1,document.getElementsByClassName("nav")[0].style.bottom="95%",document.getElementById("guirazi").style.display="block";var bokehPass=new BokehPass(scene,camera,{focus:1,aperture:.005,maxblur:5,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)}})}}),document.getElementById("guirazi").onclick=function(){minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),camerarotation=!0,document.getElementById("guirazi").style.display="none",gsap.to(controls.target,{x:-.330176,y:-.291718,z:-.113545,duration:4,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.24905360247937205,y:.44321605716014717,z:-1.7252216405242373,duration:4,onComplete:function(){controls.enabled=!0;for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!0}}),clickActive=!1;var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)};var clickActive=!1;function intersectpalazo(pos){return raycaster.setFromCamera(pos,camera),raycaster.intersectObject(cube5)}window.addEventListener("dblclick",event=>{clickMouse.x=event.clientX/window.innerWidth*2-1,clickMouse.y=-event.clientY/window.innerHeight*2+1;const found=intersectcentro(clickMouse);if(console.log(found),found.length>0&&!clickActive){for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!1;controls.enabled=!1,document.getElementsByClassName("nav")[0].style.bottom="95%",minPan=new THREE.Vector3(-1,-1,-1),maxPan=new THREE.Vector3(1,1,1),gsap.to(controls.target,{x:.5834833921060228,y:-.5405112352545162,z:.5562827011102935,duration:1,ease:"power3.inOut"}),gsap.to(camera.position,{x:.5741020778574896,y:-.5212642352545162,z:-.18861751714244523,duration:2,delay:1,onComplete:function(){camerarotation=!1,document.getElementById("guicentro").style.display="block";var bokehPass=new BokehPass(scene,camera,{focus:.1,aperture:.005,maxblur:5,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)}}),clickActive=!0}}),document.getElementById("guicentro").onclick=function(){minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),camerarotation=!0,document.getElementById("guicentro").style.display="none",gsap.to(controls.target,{x:-.330176,y:-.291718,z:-.113545,duration:4,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.24905360247937205,y:.44321605716014717,z:-1.7252216405242373,duration:4,onComplete:function(){controls.enabled=!0;for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!0}}),clickActive=!1;var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)};var clickActive=!1;window.addEventListener("mousemove",event=>{clickMouse.x=event.clientX/window.innerWidth*2-1,clickMouse.y=-event.clientY/window.innerHeight*2+1;const foundpalazo=intersectpalazo(clickMouse),foundcentro=intersectcentro(clickMouse),foundrazzi=intersectrazzi(clickMouse),foundmercato=intersectmercato(clickMouse),foundbazzar=intersect(clickMouse);foundpalazo.length>0&&!clickActive?gsap.to(outerCursor,1,{scale:2}):foundcentro.length>0&&!clickActive?gsap.to(outerCursor,1,{scale:2}):foundrazzi.length>0&&!clickActive?gsap.to(outerCursor,1,{scale:2}):foundmercato.length>0&&!clickActive?gsap.to(outerCursor,1,{scale:2}):foundbazzar.length>0&&!clickActive?gsap.to(outerCursor,1,{scale:2}):gsap.to(outerCursor,1,{scale:1})}),window.addEventListener("dblclick",event=>{clickMouse.x=event.clientX/window.innerWidth*2-1,clickMouse.y=-event.clientY/window.innerHeight*2+1;const found=intersectpalazo(clickMouse);if(console.log(found),found.length>0&&!clickActive){for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!1;document.getElementsByClassName("nav")[0].style.bottom="95%",controls.enabled=!1,minPan=new THREE.Vector3(-1,-1,-1),maxPan=new THREE.Vector3(1,1,1),gsap.to(controls.target,{x:.9993218565801543,y:-.17436976232855309,z:.4936554286869645,duration:1,ease:"power3.inOut"}),gsap.to(camera.position,{x:.6952679758442837,y:-.07447583058929784,z:.5573174043485942,duration:2,delay:1,onComplete:function(){camerarotation=!1,document.getElementById("guipalazzo").style.display="block";var bokehPass=new BokehPass(scene,camera,{focus:2,aperture:5e-4,maxblur:1,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)}}),clickActive=!0}}),document.getElementById("guipalazzo").onclick=function(){minPan=new THREE.Vector3(-.5,-.5,-.5),maxPan=new THREE.Vector3(.5,.5,.5),camerarotation=!0,document.getElementById("guipalazzo").style.display="none",gsap.to(controls.target,{x:-.330176,y:-.291718,z:-.113545,duration:4,ease:"power3.inOut"}),gsap.to(camera.position,{x:-.24905360247937205,y:.44321605716014717,z:-1.7252216405242373,duration:4,onComplete:function(){controls.enabled=!0;for(let i=16;i<scene.children.length;i++)scene.children[i].visible=!0}}),clickActive=!1;var bokehPass=new BokehPass(scene,camera,{focus:8,aperture:.001,maxblur:500,width:window.innerWidth,height:window.innerHeight});composer.addPass(bokehPass)};const clock=new THREE.Clock,param={bloomStrength:1,bloomRadius:.5,bloomThreshold:1};let rt=new THREE.WebGLRenderTarget(innerWidth,innerHeight,{type:THREE.FloatType,minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,samples:4});composer=new EffectComposer(renderer,rt);var renderPass=new RenderPass(scene,camera);composer.addPass(renderPass);const bloomPass=new UnrealBloomPass(new THREE.Vector2(window.innerWidth,window.innerHeight),param.bloomStrength,param.bloomRadius,param.bloomThreshold);composer.addPass(bloomPass);const saoPass=new SAOPass(scene,camera,sizes.width,sizes.height);composer.addPass(saoPass),saoPass.kernelRadius=16,saoPass.intensity=2e-4;const postprocessing={},effectController={focus:0,aperture:0,maxblur:0};gui.add(saoPass.params,"output",{Beauty:SAOPass.OUTPUT.Beauty,"Beauty+SAO":SAOPass.OUTPUT.Default,SAO:SAOPass.OUTPUT.SAO,Depth:SAOPass.OUTPUT.Depth,Normal:SAOPass.OUTPUT.Normal}).onChange((function(value){saoPass.params.output=parseInt(value)}));let saoBias=gui.add(saoPass.params,"saoBias",-1,1);saoBias.setValue(2);let saoIntensity=gui.add(saoPass.params,"saoIntensity",0,1).step(1e-5);saoIntensity.setValue(6e-5),gui.add(saoPass.params,"saoScale",0,10);let saoKernelRadius=gui.add(saoPass.params,"saoKernelRadius",1,100);saoKernelRadius.setValue(15),gui.add(saoPass.params,"saoMinResolution",0,1),gui.add(saoPass.params,"saoBlur");let saoBlurRadius=gui.add(saoPass.params,"saoBlurRadius",0,200);saoBlurRadius.setValue(102.1);let saoBlurStdDev=gui.add(saoPass.params,"saoBlurStdDev",.5,150);saoBlurStdDev.setValue(4);let saoBlurDepthCutoff=gui.add(saoPass.params,"saoBlurDepthCutoff",0,10);saoBlurDepthCutoff.setValue(4.072),gui.hide();const tick=()=>{if(camerarotation){var rotSpeed=7e-4,x=camera.position.x,z=camera.position.z;camera.position.x=x*Math.cos(7e-4)-z*Math.sin(7e-4),camera.position.z=z*Math.cos(7e-4)+x*Math.sin(7e-4),camera.lookAt(new Vector3(0,0,0))}const elapsedTime=.015,elapsedTime2=clock.getElapsedTime()/500;controls.update(),composer.render(scene,camera),window.requestAnimationFrame(tick),mixer1&&mixer1.update(.015);for(let i=0;i<scene.children.length;i++){const object=scene.children[i];object instanceof THREE.Points&&(object.rotation.y=-elapsedTime2*(i<4?i+1:-(i+1)))}};tick();